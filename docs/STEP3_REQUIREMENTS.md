# Step 3-3, 3-4 요구사항 명세서

## Step 3-3: 게이트 스프라이트 렌더링

### 목적
NOT 게이트를 시각적으로 렌더링하는 시스템 구현

### 기능 요구사항

#### 1. 게이트 렌더링
- NOT 게이트를 사각형으로 표현
- 입력 포트 3개 (왼쪽)
- 출력 포트 1개 (오른쪽)
- 게이트 본체와 포트 구분 렌더링

#### 2. 시각적 표현
- 게이트 본체: 회색 사각형
- 입력 포트: 작은 원 또는 사각형
- 출력 포트: 작은 원 또는 사각형
- 신호 상태에 따른 색상 변화
  - 켜짐: 밝은색
  - 꺼짐: 어두운색

#### 3. 렌더링 최적화
- 인스턴스 렌더링으로 대량 게이트 처리
- VBO/VAO 활용
- 화면 밖 게이트는 렌더링 제외 (프러스텀 컬링)

### 기술 요구사항
- OpenGL 3.3+ 셰이더 사용
- 게이트 위치, 회전, 스케일 변환 지원
- 배치 렌더링으로 드로우콜 최소화
- 메모리 효율적인 버텍스 데이터 구조

---

## Step 3-4: 와이어 라인 렌더링

### 목적
게이트 간 연결을 표시하는 와이어 렌더링 시스템 구현

### 기능 요구사항

#### 1. 와이어 렌더링
- 시작점과 끝점을 연결하는 선
- 직선 또는 꺾인 경로 지원
- 그리드에 정렬된 경로

#### 2. 시각적 표현
- 기본 상태: 회색 선
- 신호 전달 중: 밝은 색상 (예: 노란색, 녹색)
- 선 두께 조절 가능
- 연결점에 작은 원 표시

#### 3. 경로 계산
- Manhattan 거리 기반 경로
- 최소 꺾임 횟수
- 다른 게이트 회피
- 직선 우선, 필요시 꺾임

#### 4. 렌더링 최적화
- 라인 배치 렌더링
- LOD 시스템 (줌 레벨에 따른 디테일 조절)
- 화면 밖 와이어 컬링

### 기술 요구사항
- OpenGL 라인 프리미티브 사용
- 안티앨리어싱 지원
- 동적 와이어 업데이트 (드래그 중)
- 라인 스트립 또는 라인 리스트 활용

---

## 공통 구현 사항

### 렌더링 파이프라인
1. 렌더링 순서: 그리드 → 와이어 → 게이트
2. 깊이 테스팅 비활성화 (2D 렌더링)
3. 알파 블렌딩 지원

### 좌표계 변환
- 그리드 좌표계와 화면 좌표계 변환
- 카메라 변환 매트릭스 적용
- NDC (Normalized Device Coordinates) 변환

### 성능 고려사항
- 정적 객체와 동적 객체 분리
- 더티 플래그를 통한 선택적 업데이트
- GPU 메모리 최적화

### 인터페이스 설계
- Renderer 클래스에 메서드 추가
  - `renderGates(const std::vector<Gate>&)`
  - `renderWires(const std::vector<Wire>&)`
  - `renderGate(const Gate&)`
  - `renderWire(const Wire&)`

### 에러 처리
- OpenGL 에러 체크
- 셰이더 컴파일 실패 처리
- 메모리 부족 대응